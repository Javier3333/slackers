[
    {
        "user": "U02F8TTPU",
        "type": "message",
        "subtype": "channel_join",
        "text": "<@U02F8TTPU|marissa> has joined the channel",
        "ts": "1450814785.000002"
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U02F8TTPU|marissa> uploaded a file: <https:\/\/uncorked.slack.com\/files\/marissa\/F0H74SH1U\/device-2015-12-22-123042.png|view when no photo wallpaper is set>",
        "file": {
            "id": "F0H74SH1U",
            "created": 1450816323,
            "timestamp": 1450816323,
            "name": "device-2015-12-22-123042.png",
            "title": "view when no photo wallpaper is set",
            "mimetype": "image\/png",
            "filetype": "png",
            "pretty_type": "PNG",
            "user": "U02F8TTPU",
            "editable": false,
            "size": 119156,
            "mode": "hosted",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H74SH1U\/device-2015-12-22-123042.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H74SH1U\/download\/device-2015-12-22-123042.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_64": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_64.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_80": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_80.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_360": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_360.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_360_w": 203,
            "thumb_360_h": 360,
            "thumb_480": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_480.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_480_w": 270,
            "thumb_480_h": 480,
            "thumb_160": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_160.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_720": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_720.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_720_w": 405,
            "thumb_720_h": 720,
            "thumb_960": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_960.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_960_w": 540,
            "thumb_960_h": 960,
            "thumb_1024": "https:\/\/files.slack.com\/files-tmb\/T0260V1BR-F0H74SH1U-baf1e05fb2\/device-2015-12-22-123042_1024.png?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "thumb_1024_w": 576,
            "thumb_1024_h": 1024,
            "image_exif_rotation": 1,
            "original_w": 1440,
            "original_h": 2560,
            "permalink": "https:\/\/uncorked.slack.com\/files\/marissa\/F0H74SH1U\/device-2015-12-22-123042.png",
            "permalink_public": "https:\/\/slack-files.com\/T0260V1BR-F0H74SH1U-34f6ed091f",
            "channels": [
                "C0BTK9LGH"
            ],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U02F8TTPU",
        "upload": true,
        "display_as_bot": false,
        "username": "marissa",
        "bot_id": null,
        "ts": "1450816327.000003"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "error_screen was the only drawable resource I could find that seemed appropriate for that spot, but if we have updated copy\/preview image for this state, it can easily be updated",
        "ts": "1450816385.000004"
    },
    {
        "type": "message",
        "user": "U06DFL7BP",
        "text": "Rad!",
        "ts": "1450816614.000005"
    },
    {
        "type": "message",
        "user": "U06DFL7BP",
        "text": "I shared a pdf of copy, can't share the Google doc for some reason ",
        "ts": "1450816638.000006"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "I noticed a crash in MomentsImageTable.removeMomentsImage() with a SQLiteException that intermittently occurs. Not sure if that is related to my update or if it's an existing issue",
        "ts": "1450816685.000007"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "whats the stack look like",
        "ts": "1450816711.000008"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "Other than that crash, the correct preview image should be loading in that thumbnail if one exists",
        "ts": "1450816714.000009"
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U02F8TTPU|marissa> uploaded a file: <https:\/\/uncorked.slack.com\/files\/marissa\/F0H75BZHC\/-.txt|Untitled>",
        "file": {
            "id": "F0H75BZHC",
            "created": 1450816791,
            "timestamp": 1450816791,
            "name": "-.txt",
            "title": "Untitled",
            "mimetype": "text\/plain",
            "filetype": "text",
            "pretty_type": "Plain Text",
            "user": "U02F8TTPU",
            "editable": true,
            "size": 5334,
            "mode": "snippet",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H75BZHC\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H75BZHC\/download\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "permalink": "https:\/\/uncorked.slack.com\/files\/marissa\/F0H75BZHC\/-.txt",
            "permalink_public": "https:\/\/slack-files.com\/T0260V1BR-F0H75BZHC-bf3d9c8a99",
            "edit_link": "https:\/\/uncorked.slack.com\/files\/marissa\/F0H75BZHC\/-.txt\/edit",
            "preview": "12-22 12:27:56.012 7566-7782\/com.google.android.apps.workshop D\/MomentsDeleteImageService: deleting image: \/data\/data\/com.google.android.apps.workshop\/app_MomentsImage\/image%3A8372\r\n12-22 12:27:56.012 7566-7782\/com.google.android.apps.workshop E\/SQLiteLog: (1) no such column: COLUMN_ID\r\n12-22 12:27:56.082 7566-7782\/com.google.android.apps.workshop E\/AndroidRuntime: FATAL EXCEPTION: AsyncTask #4\r\n                                                                                Process: com.google.android.apps.workshop, PID: 7566\r\n                                                                                java.lang.RuntimeException: An error occured while executing doInBackground()\r",
            "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>12-22 12:27:56.012 7566-7782\/com.google.android.apps.workshop D\/MomentsDeleteImageService: deleting image: \/data\/data\/com.google.android.apps.workshop\/app_MomentsImage\/image%3A8372<\/pre><\/div>\n<div><pre>12-22 12:27:56.012 7566-7782\/com.google.android.apps.workshop E\/SQLiteLog: (1) no such column: COLUMN_ID<\/pre><\/div>\n<div><pre>12-22 12:27:56.082 7566-7782\/com.google.android.apps.workshop E\/AndroidRuntime: FATAL EXCEPTION: AsyncTask #4<\/pre><\/div>\n<div><pre>                                                                                Process: com.google.android.apps.workshop, PID: 7566<\/pre><\/div>\n<div><pre>                                                                                java.lang.RuntimeException: An error occured while executing doInBackground()<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
            "lines": 33,
            "lines_more": 28,
            "preview_is_truncated": true,
            "channels": [
                "C0BTK9LGH"
            ],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U02F8TTPU",
        "upload": true,
        "display_as_bot": false,
        "username": "marissa",
        "bot_id": null,
        "ts": "1450816791.000010"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "hm.",
        "ts": "1450816876.000011"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "that looks like it would only happen if the table hadn't been created yet?",
        "edited": {
            "user": "U026PHQ3J",
            "ts": "1450816892.000000"
        },
        "ts": "1450816886.000012"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "odd if that's the case, since I only saw it after the app was running and had loaded the image from the content provider",
        "ts": "1450817037.000014"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "when it loads the preview image, it's doing the same thing as when it gets the current image for wallpaper, except not setting the LastUsed date",
        "ts": "1450817097.000015"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "right. seems weird.",
        "ts": "1450817105.000016"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "can you force it to reproduce regularly?",
        "ts": "1450817117.000017"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "I'll keep an eye out for if it happens again",
        "ts": "1450817119.000018"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "it happens every time I go into Manage Photos and hit delete on a photo",
        "ts": "1450817207.000019"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "good. every time is good",
        "ts": "1450817221.000020"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "try moving the delete code out of the doInBackground and into the onPostExec",
        "ts": "1450817241.000021"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "my guess is that the db file handle is being held in a different thread, and the Async thread has an empty file handle and doesn't know it until it tries to operate",
        "ts": "1450817270.000022"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "(not that this is necessarily the fix, but would rule that theory out)",
        "ts": "1450817287.000023"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "(since onPostExecute happens on Main ¯\\_(ツ)_\/¯)",
        "ts": "1450817326.000024"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "hm. i thought about it for 30 more seconds, and my guess is that something else is fucked up instead of this, but this is still interesting",
        "ts": "1450817441.000025"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "(considering that the use case is well-worn)",
        "ts": "1450817460.000026"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "or maybe we've just been obscenely lucky thus far!",
        "ts": "1450817503.000027"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "yeah, I'm looking at it and I think there's something else wonky in the SQL... I think if the image lacks an ID in the DB, then that statement fails",
        "ts": "1450817517.000028"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "but I am brand new to this code base, so I may be completely off track",
        "ts": "1450817550.000029"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "interesting. there is a *really good chance* that the image i'm downloading from the endpoint isn't well-formed (since THAT use case is barely tested)",
        "ts": "1450817552.000030"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "PhotosOrderResolutionService",
        "ts": "1450817629.000031"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "ype",
        "ts": "1450817649.000032"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "yep",
        "ts": "1450817650.000033"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "your suspicon is probably correct",
        "ts": "1450817656.000034",
        "reactions": [
            {
                "name": "grin",
                "users": [
                    "U026PHQ3J"
                ],
                "count": 1
            }
        ]
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U026PHQ3J|evans> uploaded a file: <https:\/\/uncorked.slack.com\/files\/evans\/F0H75NBMF\/-.txt|Untitled>",
        "file": {
            "id": "F0H75NBMF",
            "created": 1450817672,
            "timestamp": 1450817672,
            "name": "-.txt",
            "title": "Untitled",
            "mimetype": "text\/plain",
            "filetype": "text",
            "pretty_type": "Plain Text",
            "user": "U026PHQ3J",
            "editable": true,
            "size": 251,
            "mode": "snippet",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H75NBMF\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H75NBMF\/download\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "permalink": "https:\/\/uncorked.slack.com\/files\/evans\/F0H75NBMF\/-.txt",
            "permalink_public": "https:\/\/slack-files.com\/T0260V1BR-F0H75NBMF-c2efb5bdc9",
            "edit_link": "https:\/\/uncorked.slack.com\/files\/evans\/F0H75NBMF\/-.txt\/edit",
            "preview": "                MomentsImage image = new MomentsImage();\r\n                image.setIsDefaultImage(true);\r\n                image.setDateAdded(new Date());\r\n                image.setIsInLocalStorage(true);\r\n                image.setLocalUri(localUri);\r",
            "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>                MomentsImage image = new MomentsImage();<\/pre><\/div>\n<div><pre>                image.setIsDefaultImage(true);<\/pre><\/div>\n<div><pre>                image.setDateAdded(new Date());<\/pre><\/div>\n<div><pre>                image.setIsInLocalStorage(true);<\/pre><\/div>\n<div><pre>                image.setLocalUri(localUri);<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
            "lines": 6,
            "lines_more": 1,
            "preview_is_truncated": false,
            "channels": [
                "C0BTK9LGH"
            ],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U026PHQ3J",
        "upload": true,
        "display_as_bot": false,
        "username": "evans",
        "bot_id": null,
        "ts": "1450817672.000035"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "the deletions are happening in a job, not  an async task. If the user decides to delete several images at the same time, I didn’t want to make all of those transactions on the main thread. ID should be auto incremented.",
        "ts": "1450819362.000036"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "yeah, I'm debugging it, and the database does seem to exist and the image has an id, so I'm not sure why that SQL statement says there is no such column",
        "ts": "1450819420.000037"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "there should be no column called “COLUMN_ID\"",
        "ts": "1450819499.000038"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "I tried a different column, same result. I don't want to leave stale data in the DB, but not sure how to properly delete those images",
        "ts": "1450819503.000039"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "it’s probably supposed to be using the value of a static variable, but is actually putting that string there",
        "ts": "1450819515.000040"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "I see it",
        "ts": "1450819546.000041"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "but I’m on a branch. also, I thought I had fixed this before?",
        "ts": "1450819557.000042"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "```contentResolver\n                .delete(MomentsImageContentProvider.CONTENT_URI,\n                        \"COLUMN_ID = ?\",\n                        new String[]{\"\" + image.getId()});```",
        "ts": "1450819573.000043"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "should be using the value of COLUMN_ID instead of the actual string. could you fix that <@U02F8TTPU> ?",
        "ts": "1450819589.000044"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "I’m on a different branch",
        "ts": "1450819595.000045"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "ah OK, I'm on master",
        "ts": "1450819602.000046"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "will do!",
        "ts": "1450819613.000047"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "thank you!",
        "ts": "1450819628.000048"
    },
    {
        "type": "message",
        "user": "U02F8TTPU",
        "text": "thanks for the help <@U0261PCRQ>",
        "ts": "1450819637.000049"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "no prob. it was my mistake in the first place :stuck_out_tongue:",
        "ts": "1450819655.000050"
    },
    {
        "type": "message",
        "subtype": "file_share",
        "text": "<@U02F8TTPU|marissa> uploaded a file: <https:\/\/uncorked.slack.com\/files\/marissa\/F0H783HQR\/-.txt|Untitled>",
        "file": {
            "id": "F0H783HQR",
            "created": 1450819892,
            "timestamp": 1450819892,
            "name": "-.txt",
            "title": "Untitled",
            "mimetype": "text\/plain",
            "filetype": "text",
            "pretty_type": "Plain Text",
            "user": "U02F8TTPU",
            "editable": true,
            "size": 220,
            "mode": "snippet",
            "is_external": false,
            "external_type": "",
            "is_public": true,
            "public_url_shared": false,
            "display_as_bot": false,
            "username": "",
            "url_private": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H783HQR\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "url_private_download": "https:\/\/files.slack.com\/files-pri\/T0260V1BR-F0H783HQR\/download\/-.txt?t=xoxe-2204987399-220009572576-220663233794-4d92389b8a",
            "permalink": "https:\/\/uncorked.slack.com\/files\/marissa\/F0H783HQR\/-.txt",
            "permalink_public": "https:\/\/slack-files.com\/T0260V1BR-F0H783HQR-1f56075b6a",
            "edit_link": "https:\/\/uncorked.slack.com\/files\/marissa\/F0H783HQR\/-.txt\/edit",
            "preview": "here we go: \r\n\r\ncontentResolver\r\n                .delete(MomentsImageContentProvider.CONTENT_URI,\r\n                        MomentsImageTable.COLUMN_ID + \" = ?\",\r",
            "preview_highlight": "<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text\/plain',window.getSelection().toString().replace(\/\\u200b\/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>here we go: <\/pre><\/div>\n<div><pre><\/pre><\/div>\n<div><pre>contentResolver<\/pre><\/div>\n<div><pre>                .delete(MomentsImageContentProvider.CONTENT_URI,<\/pre><\/div>\n<div><pre>                        MomentsImageTable.COLUMN_ID + &quot; = ?&quot;,<\/pre><\/div>\n<div><pre><\/pre><\/div>\n<\/div>\n<\/div>\n",
            "lines": 6,
            "lines_more": 1,
            "preview_is_truncated": false,
            "channels": [
                "C0BTK9LGH"
            ],
            "groups": [],
            "ims": [],
            "comments_count": 0
        },
        "user": "U02F8TTPU",
        "upload": true,
        "display_as_bot": false,
        "username": "marissa",
        "bot_id": null,
        "ts": "1450819892.000051"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "looks good to me",
        "ts": "1450819929.000052"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "sorry everyone",
        "ts": "1450821048.000053"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "for making a bunch of goose chases",
        "edited": {
            "user": "U026PHQ3J",
            "ts": "1450821216.000000"
        },
        "ts": "1450821055.000054"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "Drive is in a decent place on its own drive branch. There is basically 0 error handling, but it should be usable enough for Evans to work with it.",
        "ts": "1450821259.000057"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "yay!",
        "ts": "1450821275.000058"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "now to shoot some autoawesome",
        "ts": "1450821280.000059"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "of me typing on slack?",
        "ts": "1450821286.000060"
    },
    {
        "type": "message",
        "user": "U0261PCRQ",
        "text": "I did not know this existed <http:\/\/developer.android.com\/reference\/android\/support\/v4\/widget\/ContentLoadingProgressBar.html>",
        "ts": "1450822684.000061"
    },
    {
        "type": "message",
        "user": "U026PHQ3J",
        "text": "i really like that. why have we never come across this before?!",
        "ts": "1450823229.000062"
    }
]